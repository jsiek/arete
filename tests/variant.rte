type ptr_opt = variant ptr: int* | nul: ⟨⟩;

fun null_() -> ptr_opt { return tag nul(⟨⟩) as ptr_opt; }
fun ptr_(var p : int*) -> ptr_opt { return tag ptr(p) as ptr_opt; }

fun deref_ptr(x : ptr_opt, default: int) -> int {
  match (x) {
    case nul(p):
      return default;
    case ptr(p):
      return *p;
  }
}

fun main() {
  var x : ptr_opt = null_();
  var y : ptr_opt = ptr_(&42);
  return deref_ptr(x, -42) + deref_ptr(y, -42);
}